---
import BaseLayout from '@/layouts/BaseLayout.astro';
import CategoryFilter from '@/components/blog/CategoryFilter';
import Newsletter from '@/components/sections/Newsletter';
import { getAllCategories } from '@/lib/blog';

interface Props {
  title: string;
  description: string;
  image?: string;
  currentCategory?: string;
}

const { title, description, image, currentCategory } = Astro.props;

// Fetch all categories for the sidebar
const categories = await getAllCategories();
---

<BaseLayout title={title} description={description} image={image}>
  <main class="pt-8 pb-16">
    <div class="container px-4 sm:px-6 lg:px-8 mx-auto">
      <div class="flex flex-col lg:flex-row lg:gap-10">
        <!-- Main Content -->
        <div class="w-full lg:w-2/3 lg:order-1">
          <slot />
        </div>

        <!-- Sidebar -->
        <aside class="w-full lg:w-1/3 mt-10 lg:mt-0 lg:order-2">
          <div class="sticky top-24 space-y-8">
            <!-- Category Filter -->
            <div class="bg-white rounded-xl p-6 border border-mountain-green/20 shadow-sm">
              <CategoryFilter categories={categories} currentCategory={currentCategory} client:load />
            </div>
            
          </div>
        </aside>
      </div>
    </div>
  </main>
  <Newsletter />
</BaseLayout>